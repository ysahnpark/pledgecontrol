
(SELECT Name, PledgeDate, 
	AmountPerPeriod,
	PaymentPeriod,
	CEIL(TIMESTAMPDIFF(MONTH, PledgeDate, NOW())  / PaymentPeriod) as PeriodsPassed,
	CEIL(TIMESTAMPDIFF(MONTH, PledgeDate, NOW())  / PaymentPeriod) * AmountPerPeriod as  AmountDueNowRaw,
	PaidAmount,
	(CEIL(TIMESTAMPDIFF(MONTH, PledgeDate, NOW())  / PaymentPeriod) * AmountPerPeriod) - PaidAmount as AmountDueNow 
	FROM accounts WHERE PeriodUnit= 'm')
UNION
(SELECT Name, PledgeDate,  
	AmountPerPeriod,
	PaymentPeriod,
	CEIL(TIMESTAMPDIFF(WEEK, PledgeDate, NOW())  / PaymentPeriod) as PeriodsPassed,
	CEIL(TIMESTAMPDIFF(WEEK, PledgeDate, NOW())  / PaymentPeriod) * AmountPerPeriod as  AmountDueNowRaw,
	PaidAmount,
	(CEIL(TIMESTAMPDIFF(WEEK, PledgeDate, NOW())  / PaymentPeriod) * AmountPerPeriod) - PaidAmount as AmountDueNow 
	FROM accounts WHERE PeriodUnit= 'w')
ORDER BY Name;